<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Alex's Blog - Thinkpad X1 Carbon (5th gen) Notes</title>
        <link rel="stylesheet" href="../css/default.css" />
    </head>
    <body>
        <div id="header">
            <div id="logo">
                <a href="../">Alex's Blog</a>
            </div>
            <div id="navigation">
                <a href="../">Home</a>
                <a href="../archive.html">Archive</a>
            </div>
        </div>

        <div id="content">
            <h1>Thinkpad X1 Carbon (5th gen) Notes</h1>
            <div class="info">
    Posted on June 11, 2017
    
</div>

<p>如題，筆記一下最近在 X1C5 上裝 Arch Linux 的一些東西。</p>
<h1 id="總結">總結</h1>
<p>大部分不用特殊設定，運作都沒有問題。</p>
<ul>
<li>wifi</li>
<li>鍵盤背光</li>
<li>鍵盤上的指示燈(caps lock/mute/mic mute等)</li>
<li>TrackPoint/TouchPad</li>
</ul>
<p>還沒試的：</p>
<ul>
<li>WWAN</li>
<li>USB type-c</li>
<li>mini-ethernet</li>
<li>hibernate</li>
</ul>
<h1 id="trackpoint">TrackPoint</h1>
<p>這次的 X1 Carbon 的 TrackPoint 分成兩種不同的版本<a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a>： ALPS 跟 Elantech。<br />
用官方的<a href="http://pcsupport.lenovo.com/tw/zh/products/laptops-and-netbooks/thinkpad-x-series-laptops/thinkpad-x1-carbon-type-20hr-20hq/downloads/ds122148">工具程式(TrackPointDetect.exe)</a>確認我手邊的是 Elantech 的</p>
<pre><code>TouchPad-Flash Utility
2017-06-08 20:42:27
Command Line: &quot;C:\Users\alexlu\Desktop\FW_Updater_1.0.0.9\TrackPointDetect.exe&quot; 
OS: 64-bit
Pst Vendor : Elan
[ERROR]: This TrackPoint is Elan (ID:03)</code></pre>
<p>Arch Linux 2017.06 (linux-4.11.3) 的版本裝上去是可以正常運作， 但是會被辨識成為「ImPS/2 Generic Wheel Mouse」， 原因是新的 TrackPoint Firmware ID 跟以前的不相容。<br />
打上這個<a href="https://patchwork.kernel.org/patch/9565965/">patch</a>就會辨識成以前的「TPPS/2 IBM TrackPoint」， 但是 sysfs 下的 speed 跟 sensitivity 都不能正常運作 (但是至少 libinput 的 Palm detection during trackpoint use 還是會正常運作)。</p>
<p>但是，打了這個 patch 之後，trackpoint 的中鍵就辨識不到了。 原因是新 firmware 無法正確取得按鈕資訊，用這個<a href="https://patchwork.kernel.org/patch/9753099/">patch</a>解決。</p>
<p>因為 speed / sensitivity 都不能設定，libinput 的 Accel Speed 改了也沒效果，先暫時已改「Coordinate Transformation Matrix」的方法來調整小紅點的速度</p>
<h1 id="新-hotkey">新 hotkey</h1>
<p>新一代的 Thinkpad 多了幾個 hotkey 分別是：</p>
<ul>
<li><kbd>fn</kbd>+<kbd>F9</kbd> 設定工具</li>
<li><kbd>fn</kbd>+<kbd>F10</kbd> 藍芽開關</li>
<li><kbd>fn</kbd>+<kbd>F11</kbd> 鍵盤設定</li>
<li><kbd>fn</kbd>+<kbd>F12</kbd> 我的最愛(?)</li>
<li><kbd>fn</kbd>+<kbd>PrtSc</kbd> 螢幕擷取工具</li>
</ul>
<p>打上這<a href="https://patchwork.kernel.org/patch/9596129/">兩個</a> <a href="https://patchwork.kernel.org/patch/9596131/">patch</a>即可， 不過「我的最愛」跟「螢幕擷取」沒有綁定，需要的話要改 patch，就先擱置了。</p>
<p>順帶一提，這兩個patch已經進linux-4.12，<del>可以坐等更新就好</del></p>
<h1 id="指紋辨識">指紋辨識</h1>
<p>機子上裝的是 Validity Sensor 138a:0097， 目前還沒有驅動程式能用。</p>
<p>可以追蹤這幾個討論：</p>
<ul>
<li><a href="https://github.com/nmikhailov/Validity90">逆向工程的驅動(施工中)</a></li>
<li><a href="https://bugs.freedesktop.org/show_bug.cgi?id=94536">libfprint 的 bug report</a></li>
</ul>
<h1 id="references">References</h1>
<ul>
<li><a href="https://gist.github.com/gdamjan/141bb0def5f80257fae2b233ec16f3c2">gdamjan 的筆記</a></li>
<li><a href="http://fredrik.wendt.se/2017/04/26/lenovo-thinkpad-x1-carbon-5th-generation/">Fredrik 的筆記</a>，他比較慘，連 TrackPoint/TouchPad 都沒法用</li>
<li><a href="https://forums.lenovo.com/t5/forums/v3_1/forumtopicpage/board-id/tp02_en/thread-id/75464/page/29">關於觸控板的討論</a></li>
<li><a href="https://patchwork.kernel.org/patch/9768231/">關於TrackPoint的patch</a>，但是我沒有試出什麼結果…</li>
<li><a href="https://gist.github.com/ursm/6d1007f44a1d6beeb670b3c3a6a78ea4">另一個TrackPoint的patch</a>，還沒試過</li>
</ul>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p><a href="https://patchwork.kernel.org/patch/9768231/" class="uri">https://patchwork.kernel.org/patch/9768231/</a><a href="#fnref1">↩</a></p></li>
</ol>
</div>

        </div>

        <div id="footer">
            Site proudly generated by
            <a href="http://jaspervdj.be/hakyll">Hakyll</a>
        </div>
    </body>
</html>
